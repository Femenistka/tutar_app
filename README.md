# tutor_app — Учёт занятий, оплат и баланса (Streamlit)

Приложение для учёта занятий с учениками: фиксирует проведённые занятия, оплаты (в том числе авансом), автоматически считает баланс и “остаток занятий”, а также показывает аналитику по доходам и количеству занятий.

## Возможности
- **Занятия** — добавление записи о проведённом занятии: ученик, цена, дата, комментарий
- **Пополнение** — добавление оплаты (за проведённые или будущие занятия): сумма, дата, комментарий, способ оплаты
- **Баланс** — сводная таблица по каждому ученику:
  - Оплатил / Начислено / Баланс (₽)
  - Занятий в остатке (±)
  - Статус
  - “Занятий должен оплатить” и “Занятий оплачено наперёд”
- **Ученики** — добавление/удаление ученика + базовые параметры (имя, цена по умолчанию, способ оплаты)
- **Аналитика** — метрики, динамика по неделям/месяцам и доли по ученикам (Plotly)

## Экраны приложения

---

### 1) Занятия
Форма для добавления проведённого занятия:
- **Имя ученика**
- **Цена**
- **Дата**
- **Комментарий**
<img width="1227" height="461" alt="Снимок экрана 2026-02-05 в 19 16 53" src="https://github.com/user-attachments/assets/e03ad986-bf08-4bd3-acb2-b66cebb49012" />


---

### 2) Пополнение
Форма для записи оплаты (можно заранее, авансом):
- **Имя ученика**
- **Сумма оплаты**
- **Дата**
- **Комментарий**
- **Способ оплаты** (используется в аналитике для расчёта налога по оплатам картой)
<img width="1226" height="531" alt="Снимок экрана 2026-02-05 в 19 17 05" src="https://github.com/user-attachments/assets/4c5cb6d1-3a7d-4747-af45-09d217efc88f" />

---

### 3) Баланс
Сводная таблица по ученикам (основные колонки):
- **Ученик**
- **Цена (по умолч.)**
- **Оплатил**
- **Начислено**
- **Баланс (₽)**
- **Статус**
- **Занятий в остатке (±)**
- **Занятий должен оплатить**
- **Занятий оплачено наперёд**
<img width="1215" height="424" alt="Снимок экрана 2026-02-05 в 19 17 16" src="https://github.com/user-attachments/assets/456285ac-638a-4498-b5c3-3063dd60a851" />

---

### 4) Ученики
Экран управления списком учеников:
- Добавить ученика (имя, цена по умолчанию, способ оплаты)
- Удалить ученика
<img width="1213" height="755" alt="Снимок экрана 2026-02-05 в 19 17 41" src="https://github.com/user-attachments/assets/d4a58c5f-895b-4bca-8e34-8268b0a63950" />

---

### 5) Аналитика
**Общая статистика**
- Количество занятий
- Доход за всё время
- Суммарный налог: `tax = 10%`
<img width="1239" height="736" alt="Снимок экрана 2026-02-05 в 19 17 59" src="https://github.com/user-attachments/assets/68ae317d-e289-4bc1-9839-58c35c4bee2e" />
<img width="1280" height="753" alt="Снимок экрана 2026-02-05 в 19 18 12" src="https://github.com/user-attachments/assets/ee5fa1e8-3500-4084-8173-82f6922509ce" />


**Динамика**
- Переключатель: **Недели / Месяцы**
- Графики:
  - “Занятия по неделям/месяцам”
  - “Оплаты по неделям/месяцам”

**Доли по ученикам**
- Кольцевая диаграмма: доля занятий по ученикам
- Кольцевая диаграмма: доля дохода по ученикам

## Технологии
- Python
- Streamlit
- Pandas
- Plotly
- SQL (через `st.connection("postgresql", type="sql")`)
- База данных: PostgreSQL (таблицы `lessons`, `payments`) / локально может использоваться `app.db` в зависимости от конфигурации

## База данных
Ожидаются таблицы:

`payments`:
- `id`, `name`, `price`, `date`, `comment`, `pay_method`

`lessons`:
- `id`, `name`, `price`, `date`, `comment`

## Установка и запуск

### 1) Установить зависимости
```bash
python -m venv .venv
# macOS/Linux
source .venv/bin/activate
# Windows
# .venv\Scripts\activate

pip install -r requirements.txt
